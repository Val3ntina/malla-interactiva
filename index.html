<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Malla Interactiva EPA</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      background-color: #F4F4F4;
      font-family: Arial, sans-serif;
      color: #333;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #879C8F;
      margin-bottom: 40px;
    }

    .semestre {
      margin-bottom: 30px;
      border-left: 6px solid #ADC8B7;
      padding-left: 10px;
    }

    .semestre h2 {
      color: #D4C896;
    }

    .ramo {
      background-color: #FFFFFF;
      margin: 10px 0;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: 0.3s;
    }

    .ramo label {
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
    }

    .ramo input[type="checkbox"] {
      transform: scale(1.2);
      accent-color: #879C8F;
    }

    .ramo.activo {
      background-color: #F6E8B0;
      border-left: 5px solid #879C8F;
    }

    .ramo.bloqueado {
      background-color: #E2D2C6;
      opacity: 0.6;
    }

    em {
      font-style: italic;
      color: #888;
    }
  </style>
</head>
<body>
  <h1>Malla Interactiva - Educación Parvularia</h1>
  <div id="malla"></div>

  <script>
    // Simulación de carga JSON (reemplazar por fetch si se carga desde archivo externo)
    const malla = [
      {
        "nombre": "Introducción a la Educación Parvularia",
        "sigla": "EPA 1124",
        "semestre": "1°",
        "creditos": "3",
        "prerrequisitos": [],
        "observaciones": ""
      },
      {
        "nombre": "Desarrollo Infantil y Neurociencias",
        "sigla": "EPA 1120",
        "semestre": "1°",
        "creditos": "3",
        "prerrequisitos": [],
        "observaciones": ""
      },
      {
        "nombre": "Fundamentos de la Psicología del Aprendizaje Escolar",
        "sigla": "PSI 300",
        "semestre": "2°",
        "creditos": "2",
        "prerrequisitos": [],
        "observaciones": ""
      }
      // Agrega más aquí...
    ];

    const aprobados = new Set();

    function renderMalla() {
      const container = document.getElementById("malla");
      container.innerHTML = "";

      const porSemestre = {};
      malla.forEach(ramo => {
        if (!porSemestre[ramo.semestre]) porSemestre[ramo.semestre] = [];
        porSemestre[ramo.semestre].push(ramo);
      });

      Object.keys(porSemestre).sort().forEach(sem => {
        const bloque = document.createElement("div");
        bloque.className = "semestre";
        bloque.innerHTML = `<h2>Semestre ${sem}</h2>`;

        porSemestre[sem].forEach(ramo => {
          const habilitado = ramo.prerrequisitos.every(req => aprobados.has(req));
          const div = document.createElement("div");
          div.className = `ramo ${habilitado ? "activo" : "bloqueado"}`;
          div.innerHTML = `
            <label>
              <input type="checkbox" ${!habilitado ? "disabled" : ""} onchange="toggleAprobado('${ramo.sigla}')" ${aprobados.has(ramo.sigla) ? "checked" : ""}>
              <strong>${ramo.sigla}</strong>: ${ramo.nombre} (${ramo.creditos} CR)
              ${ramo.observaciones ? `<em> - ${ramo.observaciones}</em>` : ""}
            </label>
          `;
          bloque.appendChild(div);
        });

        container.appendChild(bloque);
      });
    }

    function toggleAprobado(sigla) {
      if (aprobados.has(sigla)) {
        aprobados.delete(sigla);
      } else {
        aprobados.add(sigla);
      }
      renderMalla();
    }

    renderMalla();
  </script>
</body>
</html>
